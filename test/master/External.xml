<?xml version='1.0' encoding='UTF-8'?>
<NineML xmlns="http://nineml.net/9ML/1.0">
  <MultiDynamicsWithSynapses name="Ext_Dynamics">
    <Cell>
      <MultiDynamics name="Ext_Dynamics">
        <SubDynamics name="cell">
          <ComponentClass name="Poisson">
            <Parameter dimension="per_time" name="rate"/>
            <EventSendPort name="spike_output"/>
            <Dynamics>
              <StateVariable dimension="time" name="t_next"/>
              <Regime name="default">
                <OnCondition target_regime="default">
                  <Trigger>
                    <MathInline>t &gt; t_next</MathInline>
                  </Trigger>
                  <StateAssignment variable="t_next">
                    <MathInline>one_second*random.exponential(one_second*rate) + t</MathInline>
                  </StateAssignment>
                  <OutputEvent port="spike_output"/>
                </OnCondition>
              </Regime>
              <Constant units="s" name="one_second">1.0</Constant>
            </Dynamics>
          </ComponentClass>
        </SubDynamics>
        <EventSendPortExposure sub_component="cell" port="spike_output" name="spike_output__cell"/>
      </MultiDynamics>
    </Cell>
  </MultiDynamicsWithSynapses>
  <Selection name="All">
    <Concatenate>
      <Item index="0">
        <Reference>Exc</Reference>
      </Item>
      <Item index="1">
        <Reference>Inh</Reference>
      </Item>
    </Concatenate>
  </Selection>
  <ComponentArray name="Ext">
    <Size>5</Size>
    <MultiDynamicsProperties name="Ext">
      <SubDynamicsProperties name="cell">
        <Component name="stim">
          <Definition url="/Users/tclose/git/ninemlcatalog/xml/input/Poisson.xml">Poisson</Definition>
          <Property units="per_s" name="rate">
            <SingleValue>300.0</SingleValue>
          </Property>
          <Initial units="ms" name="t_next">
            <RandomValue>
              <Component name="exponential_beta">
                <Definition url="/Users/tclose/git/ninemlcatalog/xml/randomdistribution/Exponential.xml">ExponentialDistribution</Definition>
                <Property units="unitless" name="rate">
                  <SingleValue>52638.7053487</SingleValue>
                </Property>
              </Component>
            </RandomValue>
          </Initial>
        </Component>
      </SubDynamicsProperties>
      <EventSendPortExposure sub_component="cell" port="spike_output" name="spike_output__cell"/>
    </MultiDynamicsProperties>
  </ComponentArray>
  <EventConnectionGroup name="External">
    <Source port="spike_output__cell">
      <ComponentArray name="Ext">
        <Size>5</Size>
        <MultiDynamicsProperties name="Ext">
          <SubDynamicsProperties name="cell">
            <Component name="stim">
              <Definition url="/Users/tclose/git/ninemlcatalog/xml/input/Poisson.xml">Poisson</Definition>
              <Property units="per_s" name="rate">
                <SingleValue>300.0</SingleValue>
              </Property>
              <Initial units="ms" name="t_next">
                <RandomValue>
                  <Component name="exponential_beta">
                    <Definition url="/Users/tclose/git/ninemlcatalog/xml/randomdistribution/Exponential.xml">ExponentialDistribution</Definition>
                    <Property units="unitless" name="rate">
                      <SingleValue>52638.7053487</SingleValue>
                    </Property>
                  </Component>
                </RandomValue>
              </Initial>
            </Component>
          </SubDynamicsProperties>
          <EventSendPortExposure sub_component="cell" port="spike_output" name="spike_output__cell"/>
        </MultiDynamicsProperties>
      </ComponentArray>
    </Source>
    <Destination port="input_spike__psr__External">
      <Selection name="All">
        <Concatenate>
          <Item index="0">
            <Reference>Exc</Reference>
          </Item>
          <Item index="1">
            <Reference>Inh</Reference>
          </Item>
        </Concatenate>
      </Selection>
    </Destination>
    <Connectivity>
      <Component name="OneToOne">
        <Definition url="/Users/tclose/git/ninemlcatalog/xml/connectionrule/OneToOne.xml">OneToOne</Definition>
      </Component>
    </Connectivity>
    <Delay>
      <Quantity units="ms">
        <SingleValue>1.5</SingleValue>
      </Quantity>
    </Delay>
  </EventConnectionGroup>
  <Component name="stim">
    <Definition url="/Users/tclose/git/ninemlcatalog/xml/input/Poisson.xml">Poisson</Definition>
    <Property units="per_s" name="rate">
      <SingleValue>300.0</SingleValue>
    </Property>
    <Initial units="ms" name="t_next">
      <RandomValue>
        <Component name="exponential_beta">
          <Definition url="/Users/tclose/git/ninemlcatalog/xml/randomdistribution/Exponential.xml">ExponentialDistribution</Definition>
          <Property units="unitless" name="rate">
            <SingleValue>52638.7053487</SingleValue>
          </Property>
        </Component>
      </RandomValue>
    </Initial>
  </Component>
  <Component name="OneToOne">
    <Definition url="/Users/tclose/git/ninemlcatalog/xml/connectionrule/OneToOne.xml">OneToOne</Definition>
  </Component>
  <Component name="exponential_beta">
    <Definition url="/Users/tclose/git/ninemlcatalog/xml/randomdistribution/Exponential.xml">ExponentialDistribution</Definition>
    <Property units="unitless" name="rate">
      <SingleValue>52638.7053487</SingleValue>
    </Property>
  </Component>
  <Dimension name="dimensionless"/>
  <Dimension name="per_time" t="-1"/>
  <Dimension name="time" t="1"/>
  <Unit symbol="ms" dimension="time" power="-3"/>
  <Unit symbol="per_s" dimension="per_time" power="0"/>
  <Unit symbol="s" dimension="time" power="0"/>
  <Unit symbol="unitless" dimension="dimensionless" power="0"/>
</NineML>
