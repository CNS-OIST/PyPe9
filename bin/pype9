#!/usr/bin/env bash
# Main command for PyPe9 package, which can be used to invoke all PyPe9
# functionality in a similar style to the 'git' or 'svn' commands, e.g.
#
#     pype9 simulate <simulation.xml> 100.0
#
# or
#
#     pype9 convert --version 2.0 <v1.xml> <v2.xml>

# Get platform type
platform=`uname -o`

# Get directory of package
package_dir="`readlink -f $0 | xargs dirname`/.."

# Get path to libninemlnrn directory
lib9mlnrn_dir=`realpath $package_dir/pype9/neuron/cells/code_gen/libninemlnrn`

# Add libninemlnrn to library path
if [ "$platform" = 'DARWIN' ]; then
    export DYLD_LIBRARY_PATH="$lib9mlnrn_dir:$DYLD_LIBRARY_PATH"
else
    export LD_LIBRARY_PATH="$lib9mlnrn_dir:$LD_LIBRARY_PATH"
fi

if [ $# -lt 1 ]; then
	cmd='help'
	args=''
else
	cmd=`basename $1`
	args="${@:2}"
fi

# Run python script
python `realpath $package_dir/pype9/cmd/$cmd.py` $args
