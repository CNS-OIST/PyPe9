{# This template provides code to emit spikes in GSL

   Authors: Ivan Raikov and Thomas G. Close
   Copyright Okinawa Institute of Science and Technology Graudate University 2014
#}
	//----------------------------------------------------------//
	// This section was generated from NEST-emit-spike-gsl.tmpl //
	//----------------------------------------------------------//
	if ( S_.r_ > 0 )
	   S_.r_--;
	else if (S_.y_[{{ModelName}}::State_::{{membrane_voltage}}_INDEX] >= P_.V_t &&
	    V_.U_old_ > S_.y_[{{ModelName}}::State_::{{membrane_voltage}}_INDEX]) {
	    S_.r_ = V_.RefractoryCounts_;
		set_spiketime(Time::step(origin.get_steps()+lag+1));
	   	SpikeEvent se;
		network()->send(*this, se, lag);
	}
    // ------------------- NEST-emit-spike-gsl.tmpl ------------------------//