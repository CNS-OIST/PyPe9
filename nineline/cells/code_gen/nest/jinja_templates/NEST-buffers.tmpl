{# This template adds Buffers
   classes

   Authors: Ivan Raikov and Thomas G. Close
   Copyright Okinawa Institute of Science and Technology Graudate University 2014
#}

//---------------------------------------------------//
// This section was generated from NEST-buffers.tmpl //
//---------------------------------------------------//
{% if ((ode_method == "cvode") or (ode_method == "ida")) %}
{{ModelName}}::Buffers_::Buffers_({{ModelName}}& n)
    : logger_(n),
      sys_(0) {
    // Initialization of the remaining members is deferred to
    // init_buffers_().
}


{{ModelName}}::Buffers_::Buffers_(const Buffers_&, {{ModelName}}& n)
    : logger_(n),
      sys_(0) {
    // Initialization of the remaining members is deferred to
    // init_buffers_().
}
{% elif (ode_method == "gsl") %}
{{ModelName}}::Buffers_::Buffers_({{ModelName}}& n)
    : logger_(n),
      s_(0),
      c_(0),
      e_(0),
      N(0),
      u(0),
      jac(0) {
    // Initialization of the remaining members is deferred to
    // init_buffers_().
}


{{ModelName}}::Buffers_::Buffers_(const Buffers_&, {{ModelName}}& n)
    : logger_(n),
      s_(0),
      c_(0),
      e_(0),
      N(0),
      u(0),
      jac(0) {
    // Initialization of the remaining members is deferred to
    // init_buffers_().
}
{% endif %}


void {{ModelName}}::init_buffers_() {

    // Clear event buffers
    {% for name in event_port_names %}
    B_.{{name}}_event_port.clear();
    {% endfor %}
    
    // Clear analog buffers
    {% for name in analog_port_names %}
    B_.{{name}}_analog_port.clear();
    {% endfor %}
    
    Archiving_Node::clear_history();
    
    B_.logger_.reset();
    
    B_.step_ = Time::get_resolution().get_ms();
    B_.IntegrationStep_ = B_.step_;
    
    {% for name in analog_port_names %}
    B_.{{name}}_value = 0.0;
    {% endfor %}

    {% include "NEST-init-solver.tmpl" %}    
}

// ------------------- NEST-buffers.tmpl ------------------------//